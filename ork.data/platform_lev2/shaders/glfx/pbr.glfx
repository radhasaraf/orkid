///////////////////////////////////////////////////////////////
// FxConfigs
///////////////////////////////////////////////////////////////
fxconfig fxcfg_default
{
	glsl_version = "130";
}
///////////////////////////////////////////////////////////////
// Interfaces
///////////////////////////////////////////////////////////////
uniform_set ub_vtx
{
	mat4        mv;
	mat4        mvp;
	mat3        mrot;
	vec4        modcolor;

}
///////////////////////////////////////////////////////////////
uniform_set ub_frg
{
	vec4 modcolor;
}
///////////////////////////////////////////////////////////////
// StateBlocks
///////////////////////////////////////////////////////////////
state_block sb_default : default
{
}
///////////////////////////////////////////////////////////////
// shaders
///////////////////////////////////////////////////////////////
vertex_interface iface_vgbuffer
	: ub_vtx
{
    inputs {
	    vec4 position : POSITION;
        vec3 normal : NORMAL;
        vec4 vtxcolor : COLOR0;
	    vec2 uv0 : TEXCOORD0;
	}
    outputs {
        vec4 frg_clr;
	    vec2 frg_uv0;
	    vec4 frg_nrmd;
	}
}
vertex_shader vs_rigid_gbuffer
	: iface_vgbuffer
{
    vec4 cpos  = mv * position;
    vec3 wnorm = normalize(mrot * normal);
	gl_Position = mvp*position;
	frg_clr = vec4(1.0,1.0,1.0,1.0);
	frg_uv0 = uv0;
	frg_nrmd = vec4(wnorm,-cpos.z);
}
///////////////////////////////////////////////////////////////
fragment_interface iface_fgbuffer
	: ub_frg
{
    inputs {
        vec4 frg_clr;
        vec2 frg_uv0;
        vec4 frg_nrmd;
	}
	outputs {
        layout(location = 0) vec4 out_clr;
	}
}
fragment_shader ps_gbuffer
	: iface_fgbuffer
{
	out_clr = frg_nrmd;
}
///////////////////////////////////////////////////////////////
state_block sb_pick : sb_default
{
	DepthTest=OFF;
	DepthMask=true;
	CullTest=OFF;
	BlendMode = OFF;
}
technique rigid_gbuffer
{
	fxconfig=fxcfg_default;
	pass p0
	{	vertex_shader=vs_rigid_gbuffer;
		fragment_shader=ps_gbuffer;
		state_block=sb_default;
	}
}
///////////////////////////////////////////////////////////////
